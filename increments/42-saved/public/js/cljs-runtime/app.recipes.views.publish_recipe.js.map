{"version":3,"sources":["app/recipes/views/publish_recipe.cljs"],"sourcesContent":["(ns app.recipes.views.publish-recipe\n  (:require [reagent.core :as r]\n            [re-frame.core :as rf]\n            [app.components.modal :refer [modal]]\n            [app.components.form-group :refer [form-group]]\n            [app.helpers :as h]\n            [\"@smooth-ui/core-sc\" :refer [Button Box]]))\n\n(defn publish-recipe\n  []\n  (let [initial-values {:price \"\"}\n        values (r/atom initial-values)\n        open-modal (fn [{:keys [modal-name recipe]}]\n                     (rf/dispatch [:open-modal modal-name])\n                     (reset! values recipe))\n        publish (fn [{:keys [price]}]\n                  (rf/dispatch [:publish-recipe {:price (js/parseInt price)}])\n                  (reset! values initial-values))]\n    (fn []\n      (let [{:keys [price public?]} @(rf/subscribe [:recipe])]\n        [:> Box\n         (cond\n           public? [:> Button {:on-click #(open-modal {:modal-name :publish-recipe})}\n                    (h/format-price price)]\n           (not public?) [:> Button {:on-click #(open-modal {:modal-name :publish-recipe\n                                                             :recipe {:price price}})}\n                          \"Publish\"])\n         [modal {:modal-name :publish-recipe\n                 :header \"Recipe\"\n                 :body [form-group {:id :price\n                                    :label \"Price (in cents)\"\n                                    :values values\n                                    :type \"number\"}]\n                 :footer [:<>\n                          (when public?\n                            [:a {:href \"#\"\n                                 :on-click #(rf/dispatch [:unpublish-recipe])}\n                             \"Unpublish\"])\n                          [:> Button {:on-click #(rf/dispatch [:close-modal])\n                                      :variant \"light\"}\n                           \"Cancel\"]\n                          [:> Button {:on-click #(publish @values)}\n                           \"Publish\"]]}]]))))\n"],"mappings":";;;;;;;;AAQA,AAAA,AAAMA;AAAN,AAEE,AAAA,AAAA,AAAA,AAAMC;AACAC,AAAO,AAACC,AAAOF;AACfG,AAAW;AAAAC;AAAA,AAAA,AAAAC,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAC,AAAA,AAAAD,AAAA,AAAA,AAAA,AAAA,AAAAE,AAAAC,AAAAH,AAAAA;AAAA,AAAAI,AAAAJ,AAAA,AAAaK;AAAb,AAAAD,AAAAJ,AAAA,AAAwBM;AAAxB,AACE,AAAAC,AAAA,AAAA,AAA0BF;AAA1B,AAAA,AAAAE,AAAAA,AAACC,AAAAA,AAAAA;;AACD,AAACC,AAAOb,AAAOU;;;AAC5BI,AAAQ;AAAAC;AAAA,AAAA,AAAAC,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAX,AAAA,AAAAW,AAAA,AAAA,AAAA,AAAA,AAAAV,AAAAC,AAAAS,AAAAA;AAAA,AAAAR,AAAAQ,AAAA,AAAaC;AAAb,AACE,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAsC,AAACC,AAAYF;AAAnD,AAAA,AAAAC,AAAAA,AAACN,AAAAA,AAAAA;;AACD,AAACC,AAAOb,AAAOD;;;AAP/B,AAQE;;AAAA,AACE,AAAAqB,AAAA,AAAAC,AAA+B,AAAAE,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACC,AAAAA,AAAAA;;AAAhCJ,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAf,AAAA,AAAAe,AAAA,AAAA,AAAA,AAAA,AAAAd,AAAAC,AAAAa,AAAAA;AAAA,AAAAZ,AAAAY,AAAA,AAAcH;AAAd,AAAAT,AAAAY,AAAA,AAAoBE;AAApB,AAAA,AAAA,AACMG,AACH,AAAA,AAAA,AAAA,AAAA,AAAA,AACEH,AAAYI;;AADd,AACiC,AAAA,AAAA,AAAA,AAACxB;;AADlC,AAAA,AAAA,AAAA,AAAA,AAAA,AAEW,AAACyB,AAAeV,AACzB,AAACW,AAAIN,AAAaI;;AAHpB,AAGuC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAACxB,AAC4Be;;AANvE,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAEG,AAAA,AAMCY,AAEcC,AAEoB9B,AAGlB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAMsB;;AAAN,AAEkB,AAAAS,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACnB,AAAAA,AAAAA;;AAjBvC,AAAA,AAAA,AAAA,AAAA,AAeoB,AAAA,AAIIc;;AAnBxB,AAmB2C,AAAAM,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACpB,AAAAA,AAAAA;;AAnB5C,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAsBwBc;;AAtBxB,AAsB2C,AAAA,AAAAL,AAACP,AAASd;;AAtBrD","names":["app.recipes.views.publish-recipe/publish-recipe","initial-values","values","reagent.core.atom.cljs$core$IFn$_invoke$arity$1","open-modal","p__27114","map__27115","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","modal-name","recipe","G__27117","re-frame.core/dispatch","cljs.core/reset!","publish","p__27118","map__27119","price","G__27121","js/parseInt","map__27122","cljs.core/deref","public?","G__27123","re-frame.core/subscribe","js/module$node_modules$$smooth_ui$core_sc$dist$smooth_ui_core_sc_cjs.Box","js/module$node_modules$$smooth_ui$core_sc$dist$smooth_ui_core_sc_cjs.Button","app.helpers/format-price","cljs.core/not","app.components.modal/modal","app.components.form-group/form-group","G__27125","G__27126"]}