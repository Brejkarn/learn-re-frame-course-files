{
"version":3,
"file":"module$node_modules$focus_lock$dist$cjs$focusMerge.js",
"lineCount":8,
"mappings":"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",
"sources":["node_modules/focus-lock/dist/cjs/focusMerge.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$focus_lock$dist$cjs$focusMerge\"] = function(global,process,require,module,exports,shadow$shims) {\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getFocusabledIn = exports.newFocus = undefined;\n\nvar _DOMutils = require('./utils/DOMutils');\n\nvar _firstFocus = require('./utils/firstFocus');\n\nvar _firstFocus2 = _interopRequireDefault(_firstFocus);\n\nvar _allAffected = require('./utils/all-affected');\n\nvar _allAffected2 = _interopRequireDefault(_allAffected);\n\nvar _array = require('./utils/array');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar findAutoFocused = function findAutoFocused(autoFocusables) {\n  return function (node) {\n    return !!node.autofocus || node.dataset && !!node.dataset.autofocus || autoFocusables.indexOf(node) >= 0;\n  };\n};\n\nvar newFocus = exports.newFocus = function newFocus(innerNodes, outerNodes, activeElement, lastNode, autoFocused) {\n  var cnt = innerNodes.length;\n  var firstFocus = innerNodes[0];\n  var lastFocus = innerNodes[cnt - 1];\n\n  // focus is inside\n  if (innerNodes.indexOf(activeElement) >= 0) {\n    return undefined;\n  }\n\n  var activeIndex = outerNodes.indexOf(activeElement);\n  var lastIndex = outerNodes.indexOf(lastNode || activeIndex);\n  var lastNodeInside = innerNodes.indexOf(lastNode);\n  var indexDiff = activeIndex - lastIndex;\n  var firstNodeIndex = outerNodes.indexOf(firstFocus);\n  var lastNodeIndex = outerNodes.indexOf(lastFocus);\n\n  // new focus\n  if (activeIndex === -1 || lastNodeInside === -1) {\n    return innerNodes.indexOf(autoFocused.length ? (0, _firstFocus2.default)(autoFocused) : (0, _firstFocus2.default)(innerNodes));\n  }\n  // old focus\n  if (!indexDiff && lastNodeInside >= 0) {\n    return lastNodeInside;\n  }\n  // jump out\n  if (indexDiff && Math.abs(indexDiff) > 1) {\n    return lastNodeInside;\n  }\n  // focus above lock\n  if (activeIndex <= firstNodeIndex) {\n    return cnt - 1;\n  }\n  // focus below lock\n  if (activeIndex > lastNodeIndex) {\n    return 0;\n  }\n  // index is inside tab order, but outside Lock\n  if (indexDiff) {\n    if (Math.abs(indexDiff) > 1) {\n      return lastNodeInside;\n    }\n    return (cnt + lastNodeInside + indexDiff) % cnt;\n  }\n  // do nothing\n  return undefined;\n};\n\nvar getTopCommonParent = function getTopCommonParent(baseActiveElement, leftEntry, rightEntries) {\n  var activeElements = (0, _array.asArray)(baseActiveElement);\n  var leftEntries = (0, _array.asArray)(leftEntry);\n  var activeElement = activeElements[0];\n  var topCommon = null;\n  leftEntries.filter(Boolean).forEach(function (entry) {\n    topCommon = (0, _DOMutils.getCommonParent)(topCommon || entry, entry) || topCommon;\n    rightEntries.filter(Boolean).forEach(function (subEntry) {\n      var common = (0, _DOMutils.getCommonParent)(activeElement, subEntry);\n      if (common) {\n        if (!topCommon || common.contains(topCommon)) {\n          topCommon = common;\n        } else {\n          topCommon = (0, _DOMutils.getCommonParent)(common, topCommon);\n        }\n      }\n    });\n  });\n  return topCommon;\n};\n\nvar allParentAutofocusables = function allParentAutofocusables(entries) {\n  return entries.reduce(function (acc, node) {\n    return acc.concat((0, _DOMutils.parentAutofocusables)(node));\n  }, []);\n};\n\nvar notAGuard = function notAGuard(node) {\n  return !(node.dataset && node.dataset.focusGuard);\n};\n\nvar reorderNodes = function reorderNodes(srcNodes, dstNodes) {\n  return srcNodes.map(function (dnode) {\n    return dstNodes.find(function (_ref) {\n      var node = _ref.node;\n      return dnode === node;\n    });\n  }).filter(Boolean);\n};\n\nvar getFocusabledIn = exports.getFocusabledIn = function getFocusabledIn(topNode) {\n  var entries = (0, _allAffected2.default)(topNode).filter(notAGuard);\n  var commonParent = getTopCommonParent(topNode, topNode, entries);\n  var outerNodes = (0, _DOMutils.getTabbableNodes)([commonParent], true);\n  var innerElements = (0, _DOMutils.getTabbableNodes)(entries).filter(function (_ref2) {\n    var node = _ref2.node;\n    return notAGuard(node);\n  }).map(function (_ref3) {\n    var node = _ref3.node;\n    return node;\n  });\n\n  return outerNodes.map(function (_ref4) {\n    var node = _ref4.node,\n        index = _ref4.index;\n    return {\n      node: node,\n      index: index,\n      lockItem: innerElements.indexOf(node) >= 0,\n      guard: !notAGuard(node)\n    };\n  });\n};\n\nvar getFocusMerge = function getFocusMerge(topNode, lastNode) {\n  var activeElement = document && document.activeElement;\n  var entries = (0, _allAffected2.default)(topNode).filter(notAGuard);\n\n  var commonParent = getTopCommonParent(activeElement || topNode, topNode, entries);\n\n  var innerElements = (0, _DOMutils.getTabbableNodes)(entries).filter(function (_ref5) {\n    var node = _ref5.node;\n    return notAGuard(node);\n  });\n\n  if (!innerElements[0]) {\n    innerElements = (0, _DOMutils.getAllTabbableNodes)(entries).filter(function (_ref6) {\n      var node = _ref6.node;\n      return notAGuard(node);\n    });\n    if (!innerElements[0]) {\n      return undefined;\n    }\n  }\n\n  var outerNodes = (0, _DOMutils.getTabbableNodes)([commonParent]).map(function (_ref7) {\n    var node = _ref7.node;\n    return node;\n  });\n  var orderedInnerElements = reorderNodes(outerNodes, innerElements);\n  var innerNodes = orderedInnerElements.map(function (_ref8) {\n    var node = _ref8.node;\n    return node;\n  });\n\n  var newId = newFocus(innerNodes, outerNodes, activeElement, lastNode, innerNodes.filter(findAutoFocused(allParentAutofocusables(entries))));\n\n  if (newId === undefined) {\n    return newId;\n  }\n  return orderedInnerElements[newId];\n};\n\nexports.default = getFocusMerge;\n};"],
"names":["shadow$provide","global","process","require","module","exports","shadow$shims","Object","defineProperty","value","getFocusabledIn","newFocus","undefined","_DOMutils","_firstFocus2","_firstFocus","__esModule","default","_allAffected2","_allAffected","_array","findAutoFocused","autoFocusables","node","autofocus","dataset","indexOf","exports.newFocus","innerNodes","outerNodes","activeElement","lastNode","autoFocused","cnt","length","firstFocus","lastFocus","activeIndex","lastIndex","lastNodeInside","indexDiff","firstNodeIndex","lastNodeIndex","Math","abs","getTopCommonParent","baseActiveElement","leftEntry","rightEntries","activeElements","asArray","leftEntries","topCommon","filter","Boolean","forEach","entry","getCommonParent","subEntry","common","contains","allParentAutofocusables","entries","reduce","acc","concat","parentAutofocusables","notAGuard","focusGuard","reorderNodes","srcNodes","dstNodes","map","dnode","find","_ref","exports.getFocusabledIn","topNode","commonParent","getTabbableNodes","innerElements","_ref2","_ref3","_ref4","index","lockItem","guard","getFocusMerge","document","_ref5","getAllTabbableNodes","_ref6","_ref7","orderedInnerElements","_ref8","newId"]
}
